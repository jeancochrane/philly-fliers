<div class="json-editor-form form-area no-filterbar" ng-if="ctl.userCanWrite && !ctl.error">
    <div class="container">
        <div class="row">
            <div class="col-sm-10 col-sm-offset-2">
                <div class="form-area-heading">
                    <h2>New {{ ::ctl.recordType.label }} Record</h2>
                    <div class="content-border"></div>
                </div>
                <div class="row">
                    <div class="col-sm-9" ng-class="{ 'col-sm-push-3': isRightToLeft }">
                        <ase-notifications></ase-notifications>
                        <div class="constant-fields">
                            <div class="well">
                                <h3>{{ ::ctl.recordType.label }} Location & Time</h3>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class="map" leaflet-map embed-map editable="true"></div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group"
                                            ng-class="ctl.constantFieldErrors.latitude ? 'has-error' : ''">
                                            <label class="control-label required">Latitude</label>
                                            <input type="number" class="form-control"
                                                ng-change="ctl.onGeomChanged(false)" ng-model="ctl.geom.lat">
                                            <p ng-if="ctl.constantFieldErrors.latitude"
                                                class="help-block errormsg">Value required.</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group"
                                            ng-class="ctl.constantFieldErrors.longitude ? 'has-error' : ''">
                                            <label class="control-label required">Longitude</label>
                                            <input type="number" class="form-control"
                                                ng-change="ctl.onGeomChanged(false)" ng-model="ctl.geom.lng">
                                            <p ng-if="ctl.constantFieldErrors.longitude"
                                                class="help-block errormsg">Value required.</p>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group date-picker"
                                            ng-class="ctl.constantFieldErrors.occurred ? 'has-error' : ''">
                                            <label class="control-label required">
                                                Occured From
                                            </label>
                                            <div class="input-group">
                                                <az-date-picker
                                                    id="occurred-from-datepicker"
                                                    datetime="ctl.occurredFromDate"
                                                    on-change="ctl.combineOccurredFromDateAndTime()"
                                                    placeholder="From">
                                                </az-date-picker>
                                            </div>
                                            <p ng-if="ctl.constantFieldErrors.occurred"
                                                class="help-block errormsg">{{ctl.constantFieldErrors.occurred}}</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group time-picker">
                                            <timepicker
                                                class="input-group"
                                                ng-model="ctl.occurredFromTime"
                                                show-meridian="false"
                                                ng-change="ctl.combineOccurredFromDateAndTime()">
                                            </timepicker>
                                        </div>
                                    </div>
                                </div>

                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group date-picker"
                                            ng-class="ctl.constantFieldErrors.occurredTo ? 'has-error' : ''">
                                            <label class="control-label">Occurred To</label>
                                            <div class="input-group">
                                                <az-date-picker
                                                    id="occurred-to-datepicker"
                                                    datetime="ctl.occurredToDate"
                                                    on-change="ctl.combineOccurredToDateAndTime()"
                                                    placeholder="To">
                                                </az-date-picker>
                                            </div>
                                            <p ng-if="ctl.constantFieldErrors.occurredTo"
                                                class="help-block errormsg">{{ctl.constantFieldErrors.occurredTo}}</p>
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group time-picker">
                                            <div class="input-group"
                                                timepicker
                                                ng-model="ctl.occurredToTime"
                                                ng-change="ctl.combineOccurredToDateAndTime()">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <json-editor editor-id="{{ ctl.editor.id }}"
                                    options="ctl.editor.options"
                                    on-data-change="ctl.onDataChange"
                                    class="form-area-body">
                        </json-editor>
                    </div>
                    <div class="col-sm-3" ng-class="{ 'col-sm-pull-9': isRightToLeft }">
                        <div class="save-area">
                            <button type="button" class="btn btn-primary btn-block"
                                ng-disabled="ctl.editor.errors.length > 0 || ctl.constantFieldErrors"
                                ng-click="ctl.onSaveClicked()">
                                Save {{ ::ctl.recordType.label }}
                            </button>
                            <button type="button" class="btn btn-warning btn-block" ng-if="ctl.record"
                                ng-click="ctl.onDeleteClicked()">
                                Delete {{ ::ctl.recordType.label }}
                            </button>
                            <button type="button" class="btn btn-default btn-block" ng-click="ctl.goBack()">
                                Cancel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="form-area no-filterbar" ng-if="::!ctl.userCanWrite">
    <!-- Shouldn't get here, but have a message to display, just in case -->
    <h2>Current user does not have access to write records.</h2>
</div>
<div class="form-area no-filterbar" ng-if="::ctl.error">
    <!-- Shouldn't get here, but have a message to display, just in case -->
    <h2>{{ctl.error}}</h2>
</div>
